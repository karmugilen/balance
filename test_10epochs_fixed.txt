/home/kar/Gem/ilwt_150epoch/ilwt_main.py:1179: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=False)
ILWT Steganography Training and Testing
==================================================
Loaded 100 images
Dataset split:
  Total: 100
  Train: 70 (70.0%)
  Val:   15 (15.0%)
  Test:  15 (15.0%)

Training ILWT Steganography Model (with enhanced metrics and validation)...
Using device: cuda
Model parameters: 624,503
SAFE GPU optimizations: batch_size=1, num_workers=4, pin_memory=True, AMP=False
/home/kar/Gem/ilwt_150epoch/ilwt_main.py:1232: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=use_amp):
    [Batch 0 Gradients] log_wLL: 0.0000681, log_kY: -0.0006163, log_kC: -0.0057613
/home/kar/Gem/ilwt_150epoch/ilwt_main.py:1301: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=use_amp):
/home/kar/Gem/ilwt_150epoch/ilwt_main.py:1353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.no_grad(), torch.cuda.amp.autocast(enabled=use_amp):
Epoch 1/10, Train Loss: 353.371416, Hiding PSNR: 28.38, Recovery PSNR: 11.72, Rec SSIM: 0.2575, ACC: 0.5655, w_hid: 0.0413, w_rec: 0.9586
  Learnable Weights: LL=0.2753, LH=0.2641, HL=0.2640, HH=0.1159, LL2=0.2225
  YCbCr Scaling: kY=0.0297, kC=0.1322
  Val Loss: 224.781960, Val Hid PSNR: 28.61, Val Rec PSNR: 12.95, Val Rec SSIM: 0.3356, Val ACC: 0.5829
  *** New best model saved! Recovery PSNR: 11.72 dB ***
Epoch 2/10, Train Loss: 133.787572, Hiding PSNR: 23.12, Recovery PSNR: 18.78, Rec SSIM: 0.4922, ACC: 0.5536, w_hid: 0.1201, w_rec: 0.8799
  Learnable Weights: LL=0.3034, LH=0.3902, HL=0.3897, HH=0.1979, LL2=0.3051
  YCbCr Scaling: kY=0.0299, kC=0.2414
  Val Loss: 91.568782, Val Hid PSNR: 22.96, Val Rec PSNR: 16.09, Val Rec SSIM: 0.3470, Val ACC: 0.5971
  *** New best model saved! Recovery PSNR: 18.78 dB ***
Epoch 3/10, Train Loss: 72.961372, Hiding PSNR: 21.09, Recovery PSNR: 17.63, Rec SSIM: 0.4262, ACC: 0.6591, w_hid: 0.3353, w_rec: 0.6647
  Learnable Weights: LL=0.2902, LH=0.4007, HL=0.4059, HH=0.2781, LL2=0.2941
  YCbCr Scaling: kY=0.0406, kC=0.2997
  Val Loss: 49.410151, Val Hid PSNR: 21.47, Val Rec PSNR: 18.74, Val Rec SSIM: 0.4255, Val ACC: 0.6408
Epoch 4/10, Train Loss: 77.687552, Hiding PSNR: 22.11, Recovery PSNR: 18.28, Rec SSIM: 0.6275, ACC: 0.6471, w_hid: 0.2714, w_rec: 0.7286
  Learnable Weights: LL=0.2849, LH=0.3939, HL=0.4052, HH=0.3394, LL2=0.2914
  YCbCr Scaling: kY=0.0550, kC=0.2913
  Val Loss: 55.279408, Val Hid PSNR: 21.71, Val Rec PSNR: 18.16, Val Rec SSIM: 0.4052, Val ACC: 0.6197
Epoch 5/10, Train Loss: 56.875884, Hiding PSNR: 22.26, Recovery PSNR: 20.93, Rec SSIM: 0.5617, ACC: 0.6448, w_hid: 0.2942, w_rec: 0.7058
  Learnable Weights: LL=0.2812, LH=0.3838, HL=0.3986, HH=0.3740, LL2=0.2905
  YCbCr Scaling: kY=0.0752, kC=0.2783
  Val Loss: 47.161148, Val Hid PSNR: 22.53, Val Rec PSNR: 18.79, Val Rec SSIM: 0.4336, Val ACC: 0.6379
  *** New best model saved! Recovery PSNR: 20.93 dB ***
  Checkpoint saved: checkpoints/checkpoint_epoch_5.pth
Epoch 6/10, Train Loss: 43.556408, Hiding PSNR: 22.57, Recovery PSNR: 16.75, Rec SSIM: 0.5009, ACC: 0.6530, w_hid: 0.3346, w_rec: 0.6654
  Learnable Weights: LL=0.2822, LH=0.3780, HL=0.3905, HH=0.3868, LL2=0.2934
  YCbCr Scaling: kY=0.0868, kC=0.2712
  Val Loss: 45.327906, Val Hid PSNR: 22.92, Val Rec PSNR: 19.16, Val Rec SSIM: 0.4808, Val ACC: 0.6349
Epoch 7/10, Train Loss: 51.308926, Hiding PSNR: 23.55, Recovery PSNR: 19.52, Rec SSIM: 0.3930, ACC: 0.6318, w_hid: 0.3782, w_rec: 0.6218
  Learnable Weights: LL=0.2776, LH=0.3687, HL=0.3816, HH=0.3863, LL2=0.2878
  YCbCr Scaling: kY=0.0916, kC=0.2731
  Val Loss: 38.147284, Val Hid PSNR: 22.88, Val Rec PSNR: 20.17, Val Rec SSIM: 0.5186, Val ACC: 0.6791
Epoch 8/10, Train Loss: 42.413674, Hiding PSNR: 22.17, Recovery PSNR: 19.21, Rec SSIM: 0.5527, ACC: 0.5950, w_hid: 0.2594, w_rec: 0.7406
  Learnable Weights: LL=0.2808, LH=0.3665, HL=0.3820, HH=0.3892, LL2=0.2929
  YCbCr Scaling: kY=0.0946, kC=0.2742
  Val Loss: 43.516241, Val Hid PSNR: 22.83, Val Rec PSNR: 19.93, Val Rec SSIM: 0.4807, Val ACC: 0.6456
Epoch 9/10, Train Loss: 38.082460, Hiding PSNR: 23.47, Recovery PSNR: 21.69, Rec SSIM: 0.5728, ACC: 0.6685, w_hid: 0.1634, w_rec: 0.8366
  Learnable Weights: LL=0.2745, LH=0.3561, HL=0.3727, HH=0.3849, LL2=0.2844
  YCbCr Scaling: kY=0.0959, kC=0.2702
  Val Loss: 38.184809, Val Hid PSNR: 23.21, Val Rec PSNR: 20.04, Val Rec SSIM: 0.4677, Val ACC: 0.6532
  *** New best model saved! Recovery PSNR: 21.69 dB ***
QApplication: invalid style override 'kvantum' passed, ignoring it.
	Available styles: Windows, Fusion
Epoch 10/10, Train Loss: 39.001335, Hiding PSNR: 21.66, Recovery PSNR: 18.32, Rec SSIM: 0.4333, ACC: 0.6007, w_hid: 0.4282, w_rec: 0.5718
  Learnable Weights: LL=0.2729, LH=0.3528, HL=0.3701, HH=0.3834, LL2=0.2826
  YCbCr Scaling: kY=0.0954, kC=0.2687
  Val Loss: 37.313159, Val Hid PSNR: 23.14, Val Rec PSNR: 20.29, Val Rec SSIM: 0.5130, Val ACC: 0.6565
  Checkpoint saved: checkpoints/checkpoint_epoch_10.pth
Training metrics saved to research_metrics/training_metrics.json
Training completed!

Model saved as 'ilwt_steganography_model_research.pth'

Testing model on 5 samples...
Sample 1: Hiding PSNR=22.83 dB, Recovery PSNR=21.64 dB, Hiding SSIM=0.5550, Recovery SSIM=0.6325, ACC=0.6900, BPP=24.00
Sample 2: Hiding PSNR=20.60 dB, Recovery PSNR=17.58 dB, Hiding SSIM=0.5130, Recovery SSIM=0.6429, ACC=0.6506, BPP=24.00
Sample 3: Hiding PSNR=22.73 dB, Recovery PSNR=21.47 dB, Hiding SSIM=0.5438, Recovery SSIM=0.6330, ACC=0.7082, BPP=24.00
Sample 4: Hiding PSNR=23.41 dB, Recovery PSNR=22.54 dB, Hiding SSIM=0.6016, Recovery SSIM=0.5665, ACC=0.6717, BPP=24.00
Sample 5: Hiding PSNR=22.86 dB, Recovery PSNR=21.39 dB, Hiding SSIM=0.5346, Recovery SSIM=0.4900, ACC=0.6617, BPP=24.00

======================================================================
TESTING COMPLETED - SUMMARY STATISTICS
======================================================================
Average Hiding PSNR:           22.49 dB
Average Recovery PSNR:         20.92 dB
Average Hiding SSIM:           0.5496
Average Recovery SSIM:         0.5930
Average Bit Accuracy:          0.6764
Average Hiding MSE:            0.023190
Average Recovery MSE:          0.035434
Average Extraction Success:    0.0000
Average Bit Error Rate (BER):  0.3236
Average Hiding Ratio (HR):     0.9797
Average Bitrate Increase (BIR): 0.020698
Bits Per Pixel (BPP):         24.00

Test results saved in 'ilwt_test_results' directory
Detailed test metrics saved to research_metrics/test_metrics.json
======================================================================

======================================================================
GENERATING PUBLICATION-READY OUTPUTS
======================================================================
Publication plots saved to publication_outputs/plots
LaTeX tables saved to publication_outputs/tables
Comprehensive metrics exported to publication_outputs/metrics

======================================================================
ALL PUBLICATION OUTPUTS GENERATED SUCCESSFULLY!
======================================================================
Outputs saved to:
  - publication_outputs/plots/     (300 DPI PDF/PNG)
  - publication_outputs/tables/    (LaTeX tables)
  - publication_outputs/metrics/   (JSON, CSV, Markdown)
  - checkpoints/                   (Model checkpoints)
======================================================================
Research plots saved in research_plots/ directory
